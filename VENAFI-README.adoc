= Venafi Provider
:toc: macro

toc::[]

The Venafi Provider allows the certificate operator to plug into Venafi and store the certificates in Venafi.

== Prerequisites

* link:https://github.com/operator-framework/operator-sdk/tree/v0.0.6[Operator SDK v0.0.6]
* link:https://golang.github.io/dep/docs/installation.html[Dep]

== Installation

[source,bash]
----
git clone [this repo]
dep ensure
----

==== Local Venafi Run

*Required:*
[source,bash]
----
export OPERATOR_NAME=cert-operator
export VENAFI_API_URL=https://myvenafi.com/api
export VENAFI_USER_NAME=myusername
export VENAFI_PASSWORD=mypassword
export VENAFI_CERT_ZONE='myzone'
----

*Optional:*
[source,bash]
----
export CERT_OP_CONFIG=/etc/cert-operator/config.yaml
export VENAFI_CA_PATH=/path/to/cert
export VENAFI_ORGANIZATION=myorganization
export VENAFI_ORGANIZATION_UNIT=myorganizationunit
export VENAFI_LOCALITY=mylocality
export VENAFI_PROVINCE=myprovince
export VENAFI_COUNTRY=mycountry
----

[source,bash]
----
oc login ...
oc new-project cert-operator
oc process -f deploy/rbac.yaml -p NAMESPACE=cert-operator | oc apply -f-
operator-sdk up local
----

== Deployment to OpenShift

[source,bash]
----
oc process -f build/build.yml | oc apply -f-
oc process -f deploy/rbac.yaml -p NAMESPACE=cert-operator | oc apply -f-
oc apply -f deploy/cert-operator-template.yaml
----
